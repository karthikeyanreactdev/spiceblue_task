{"ast":null,"code":"import _toConsumableArray from\"G:/s3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"G:/s3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"G:/s3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"G:/s3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"G:/s3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,Fragment}from'react';import{Switch,Route}from'react-router-dom';import{rolesConfig}from'../config/roles';import*as Routes from'./index';import axios from'axios';import Navigation from'../components/Navigation';import NotFound from'../components/NotFound';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PrivateRoutes=/*#__PURE__*/function(_Component){_inherits(PrivateRoutes,_Component);var _super=_createSuper(PrivateRoutes);function PrivateRoutes(){var _this;_classCallCheck(this,PrivateRoutes);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={allowedRoutes:[]};return _this;}_createClass(PrivateRoutes,[{key:\"componentDidMount\",value:function componentDidMount(){var token=JSON.parse(localStorage.getItem('token'));//adding headers on all requests to backend for verification\naxios.interceptors.request.use(function(config){config.headers['Authorization']='Bearer '+token;config.headers['Accept']='application/json';config.headers['Content-Type']='application/json';return config;});var allowedRoutes=null;var roles=[\"admin\"];if(roles){roles=_toConsumableArray(roles);allowedRoutes=roles.reduce(function(acc,role){return[].concat(_toConsumableArray(acc),_toConsumableArray(rolesConfig[role].routes));},[]);}else{this.props.history.push('/');}this.setState({allowedRoutes:allowedRoutes});}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Navigation,{routes:this.state.allowedRoutes,path:this.props.match.path}),/*#__PURE__*/_jsxs(Switch,{children:[this.state.allowedRoutes.map(function(route){return/*#__PURE__*/_jsx(Route,{exact:true,component:Routes[route.component],path:\"\".concat(_this2.props.match.path).concat(route.url)},route.url);}),/*#__PURE__*/_jsx(Route,{component:NotFound})]})]});}}]);return PrivateRoutes;}(Component);export default PrivateRoutes;","map":{"version":3,"sources":["G:/s3/src/routes/PrivateRoutes.js"],"names":["React","Component","Fragment","Switch","Route","rolesConfig","Routes","axios","Navigation","NotFound","PrivateRoutes","state","allowedRoutes","token","JSON","parse","localStorage","getItem","interceptors","request","use","config","headers","roles","reduce","acc","role","routes","props","history","push","setState","match","path","map","route","component","url"],"mappings":"omBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,CAAiBC,KAAjB,KAA8B,kBAA9B,CACA,OAASC,WAAT,KAA4B,iBAA5B,CACA,MAAO,GAAKC,CAAAA,MAAZ,KAAwB,SAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CACA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,C,2FAEMC,CAAAA,a,uVACLC,K,CAAQ,CAAEC,aAAa,CAAE,EAAjB,C,0EAER,4BAAoB,CAEnB,GAAMC,CAAAA,KAAK,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAX,CAAd,CACA;AACAV,KAAK,CAACW,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,SAAUC,MAAV,CAAkB,CAChDA,MAAM,CAACC,OAAP,CAAgB,eAAhB,EAAmC,UAAWT,KAA9C,CACAQ,MAAM,CAACC,OAAP,CAAgB,QAAhB,EAA4B,kBAA5B,CACAD,MAAM,CAACC,OAAP,CAAgB,cAAhB,EAAkC,kBAAlC,CAEA,MAAOD,CAAAA,MAAP,CACA,CAND,EAOA,GAAIT,CAAAA,aAAa,CAAC,IAAlB,CAEE,GAAIW,CAAAA,KAAK,CAAG,CAAC,OAAD,CAAZ,CACA,GAAIA,KAAJ,CAAW,CACVA,KAAK,oBAAOA,KAAP,CAAL,CACCX,aAAa,CAAGW,KAAK,CAACC,MAAN,CAAa,SAACC,GAAD,CAAMC,IAAN,CAAe,CAC5C,mCAAWD,GAAX,qBAAmBpB,WAAW,CAACqB,IAAD,CAAX,CAAkBC,MAArC,GACA,CAFgB,CAEd,EAFc,CAAhB,CAGD,CALD,IAKO,CACN,KAAKC,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,GAAxB,EACA,CAEH,KAAKC,QAAL,CAAc,CAAEnB,aAAa,CAAbA,aAAF,CAAd,EAEA,C,sBAED,iBAAS,iBACR,mBACC,MAAC,QAAD,yBACC,KAAC,UAAD,EACC,MAAM,CAAE,KAAKD,KAAL,CAAWC,aADpB,CAEC,IAAI,CAAE,KAAKgB,KAAL,CAAWI,KAAX,CAAiBC,IAFxB,EADD,cAKC,MAAC,MAAD,YACE,KAAKtB,KAAL,CAAWC,aAAX,CAAyBsB,GAAzB,CAA6B,SAACC,KAAD,qBAC7B,KAAC,KAAD,EACC,KAAK,KADN,CAGC,SAAS,CAAE7B,MAAM,CAAC6B,KAAK,CAACC,SAAP,CAHlB,CAIC,IAAI,WAAK,MAAI,CAACR,KAAL,CAAWI,KAAX,CAAiBC,IAAtB,SAA6BE,KAAK,CAACE,GAAnC,CAJL,EAEMF,KAAK,CAACE,GAFZ,CAD6B,EAA7B,CADF,cASC,KAAC,KAAD,EAAO,SAAS,CAAE5B,QAAlB,EATD,GALD,GADD,CAmBA,C,2BAlD0BR,S,EAqD5B,cAAeS,CAAAA,aAAf","sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport { rolesConfig } from '../config/roles';\nimport * as Routes from './index';\nimport axios from 'axios';\nimport Navigation from '../components/Navigation';\nimport NotFound from '../components/NotFound';\n\nclass PrivateRoutes extends Component {\n\tstate = { allowedRoutes: [] };\n\n\tcomponentDidMount() {\n\t\n\t\tconst token = JSON.parse(localStorage.getItem('token'));\n\t\t//adding headers on all requests to backend for verification\n\t\taxios.interceptors.request.use(function (config) {\n\t\t\tconfig.headers.['Authorization'] = 'Bearer ' +token;\n\t\t\tconfig.headers.['Accept'] = 'application/json';\n\t\t\tconfig.headers.['Content-Type'] = 'application/json';\n\n\t\t\treturn config;\n\t\t})\n\t\tlet allowedRoutes=null\n\t\t\t\t\t\t\t\n\t\t\t\tlet roles = [\"admin\"];\t\t\t\t\n\t\t\t\tif (roles) {\n\t\t\t\t\troles = [...roles];\n\t\t\t\t\t allowedRoutes = roles.reduce((acc, role) => {\n\t\t\t\t\t\treturn [...acc, ...rolesConfig[role].routes];\n\t\t\t\t\t}, []);\n\t\t\t\t} else {\n\t\t\t\t\tthis.props.history.push('/');\n\t\t\t\t}\n\t\t\n\t\tthis.setState({ allowedRoutes });\n\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<Navigation\n\t\t\t\t\troutes={this.state.allowedRoutes}\n\t\t\t\t\tpath={this.props.match.path}\n\t\t\t\t/>\n\t\t\t\t<Switch>\n\t\t\t\t\t{this.state.allowedRoutes.map((route) => (\n\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\texact\n\t\t\t\t\t\t\tkey={route.url}\n\t\t\t\t\t\t\tcomponent={Routes[route.component]}\n\t\t\t\t\t\t\tpath={`${this.props.match.path}${route.url}`}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t\t<Route component={NotFound} />\n\t\t\t\t</Switch>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nexport default PrivateRoutes;\n"]},"metadata":{},"sourceType":"module"}